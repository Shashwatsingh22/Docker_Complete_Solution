#-------------------------------------------------------------------------------------------------------------------------------
#-------------------------------------------------------------------------------------------------------------------------------
#-------------------------------------------  PlayBooK For the Complete Setup --------------------------------------------------
#-------------------------------------------------------------------------------------------------------------------------------
#------------------                    1. It wll Configure Docker and start the Service                       ------------------
#-------------------------------------------------------------------------------------------------------------------------------
#--------------      2. It will also configure the API so that we can able to control the docker with project.     -------------
#-------------------------------------------------------------------------------------------------------------------------------
#-------------------------------------------------------------------------------------------------------------------------------

- hosts :
        - tag_Name_Webserver

  tasks:
        - name: "Installation Of Docker....."
          package:
                name:
                        - docker
                        - docker.io
                state: present
          register: installation_status
          when : ansible_os_family == "Debian"

        - name: "Installation Status....."
          debug:
                msg: "Docker Installation Completed! :)"
          when: "installation_status.failed == false"


        - name: "Starting Docker Service......."
          service:
                name : docker
                state : started
                enabled : yes
          register: service_status

        - name: "Docker Service Status......"
          debug :
                msg : "Docker Service Started Finally :)"
          when: "service_status.failed == false"        

        - name: "Replacing the docker service file....."
          copy:
                src: docker.service
                dest: /lib/systemd/system/docker.service

        - name: "daemon reload"
          systemd:
                name: docker.service
                state: reloaded

        - name: "Enabling services docker"
          service:
                name: docker
                state: restarted
